package org.panacea.drmp.age.domain.graph;

import org.neo4j.ogm.annotation.*;

import java.util.HashSet;
import java.util.Set;

@RelationshipEntity(type = "HEXPLOIT")
public class HExploit<S1 extends HPrivilege,S2 extends HPrivilege> {
	@Id
	@GeneratedValue
	public Long id;

	public Set<String> vulnerabilities = new HashSet<>();

	@StartNode
	public S1 fromPrivilege;

	@EndNode
	public S2 toPrivilege;

	public HExploit(){}

	public HExploit(S1 fromPrivilege, S2 toPrivilege) {
		this.fromPrivilege = fromPrivilege;
		this.toPrivilege = toPrivilege;
	}

	@Override
	public String toString() {
		return "HExploit{" +
				"id=" + id +
				", vulnerabilities=" + vulnerabilities.toString() +
				", fromPrivilege=" + fromPrivilege +
				", toPrivilege=" + toPrivilege +
				'}';
	}

	public void addVulnerability(String v) {
		if (this.vulnerabilities == null) {
			this.vulnerabilities = new HashSet<>();
		}
		this.vulnerabilities.add(v);
	}


}
