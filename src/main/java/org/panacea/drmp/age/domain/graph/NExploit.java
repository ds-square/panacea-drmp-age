package org.panacea.drmp.age.domain.graph;

import org.neo4j.ogm.annotation.*;

import java.util.HashSet;
import java.util.Set;

@RelationshipEntity(type = "EXPLOIT")
public class NExploit<S1 extends NDPrivilege,S2 extends NDPrivilege> {
	@Id
	@GeneratedValue
	public Long id;

	public Set<String> vulnerabilities = new HashSet<>();

	@StartNode
	public S1 fromPrivilege;

	@EndNode
	public S2 toPrivilege;


	public NExploit(){}

	public NExploit(S1 fromPrivilege, S2 toPrivilege) {
		this.fromPrivilege = fromPrivilege;
		this.toPrivilege = toPrivilege;
	}


	@Override
	public String toString() {
		return "NExploit{" +
				"id=" + id +
				", vulnerabilities=" + vulnerabilities.toString() +
				", fromPrivilege=" + fromPrivilege +
				", toPrivilege=" + toPrivilege +
				'}';
	}

	public void addVulnerability(String cve) {
		if (this.vulnerabilities == null) {
			this.vulnerabilities = new HashSet<>();
		}
		this.vulnerabilities.add(cve);
	}


}
